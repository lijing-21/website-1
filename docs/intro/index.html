<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-intro">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">About AREX | Real automated API testing with real data.</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-test-site.com/website/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-test-site.com/website/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/website/docs/intro"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="About AREX | Real automated API testing with real data."><meta data-rh="true" name="description" content="AREX"><meta data-rh="true" property="og:description" content="AREX"><link data-rh="true" rel="icon" href="/website/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/website/docs/intro"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/website/docs/intro" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/website/docs/intro" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/website/blog/rss.xml" title="Real automated API testing with real data. RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/website/blog/atom.xml" title="Real automated API testing with real data. Atom Feed"><link rel="stylesheet" href="/website/assets/css/styles.0bcd600d.css">
<link rel="preload" href="/website/assets/js/runtime~main.22450e7a.js" as="script">
<link rel="preload" href="/website/assets/js/main.b1b7ac85.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/website/"><div class="navbar__logo"><img src="/website/img/logo.png" alt="AREX Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/website/img/logo.png" alt="AREX Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">AREX</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/website/docs/intro">Doc</a><a class="navbar__item navbar__link" href="/website/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/arextest" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/website/docs/intro">About AREX</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/website/docs/category/get-started">Get Started</a><button aria-label="Toggle the collapsible sidebar category &#x27;Get Started&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/website/docs/category/normal-api-testing">Normal API testing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Normal API testing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/website/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">About AREX</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>About AREX</h1><img loading="lazy" src="https://avatars.githubusercontent.com/u/103105168?s=200&amp;v=4" alt="Arex Icon" width="27" height="" class="img_ev3q">AREX<p><strong>Real automated API testing with real data.</strong></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="background">Background<a href="#background" class="hash-link" aria-label="Direct link to Background" title="Direct link to Background">​</a></h3><p>For newly launched simple services, testing can be accomplished through a combination of automated and manual testing. However, for complex online business systems that undergo frequent updates, it is crucial to ensure the accuracy of core business functions during modifications.</p><p>Traditional automation testing often requires significant human resources for test data preparation and script creation, and may not provide adequate coverage. To maintain the stability of online systems, both developers and testers face the following challenges:</p><ul><li>After development, it can be challenging to quickly verify locally and identify initial issues.</li><li>Preparing test data, writing and maintaining automation scripts are time-consuming and may not provide adequate coverage.</li><li>It is difficult to verify the data written to services, and testing may produce dirty data, such as in our core trading system, which may write data to databases, message queues, Redis, etc. This data is often difficult to verify, and the data generated by testing is also difficult to clean up.</li><li>Online issues are difficult to reproduce locally, making it difficult to debug.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-arex">What is AREX?<a href="#what-is-arex" class="hash-link" aria-label="Direct link to What is AREX?" title="Direct link to What is AREX?">​</a></h3><p>AREX is a tool that automates regression testing by recording real traffic from the online environment to the test environment, solving the problem of regression testing. AREX uses Java&#x27;s instrument to implement data collection and automated mocking without code intrusion. The intelligent mocking mechanism allows the test to run the code on the application being tested, without causing real external interactions (such as writing to the database or calling other services), and also perfectly supports testing of written interfaces (such as core transaction systems and inventory systems).</p><p>AREX supports various types of API testing, including:</p><ul><li>API testing, similar to Postman testing, with case setting, execution, and result assertions.</li><li>Comparison testing, which sends the same request to different interfaces and compares the differences in the returned results, supporting both non-MOCK and AREX real data MOCK testing.</li><li>Replay testing, which uses real production data for comparison testing.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="how-it-works">How it works<a href="#how-it-works" class="hash-link" aria-label="Direct link to How it works" title="Direct link to How it works">​</a></h4><p>We assume that the applications in production environment will normally respond to users&#x27; requests. By using the AOP approach, it saves the request parameters and return results, as well as some snapshot data of the execution process, such as the input and output of accessing the database and the input and output of accessing the remote server. Then the snapshot data is sent to the test machine (which with code changes) to complete a replay process. By comparing the snapshot data, the data of the backend requests and the returned results with the data of the real online requests, the differences are found and the problems of the system under test are identified.</p><p><img loading="lazy" src="/website/assets/images/arexintroduce-c3237bba73ad273a38c8e24e26664775.jpeg" width="1080" height="218" class="img_ev3q"></p><ul><li>xxxTestCase: The collected data that used as a test case during Replay.</li><li>xxxMock：Mock with collecte data during replay, instead of real data.</li><li>xxxExpect and xxxReal：After the test, verify the recorded and replay data to discover hidden dangers in the code</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="technical-principle">Technical Principle<a href="#technical-principle" class="hash-link" aria-label="Direct link to Technical Principle" title="Direct link to Technical Principle">​</a></h4><p>The Java Development Kit 1.5 introduced the java.lang.Instrument package, which provides the necessary tools for developers to dynamically modify classes within a system at runtime, thereby enhancing the functionality of the original class. Many contemporary tools, such as the open-source arthas and the monitoring tool SkyWalking, are built on this technology. AREX&#x27;s data collection and automatic mocking are also rooted in this technology.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="advantages">Advantages<a href="#advantages" class="hash-link" aria-label="Direct link to Advantages" title="Direct link to Advantages">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="low-cost">Low Cost<a href="#low-cost" class="hash-link" aria-label="Direct link to Low Cost" title="Direct link to Low Cost">​</a></h4><p>No code intrusion, low integration cost.
No need to write test cases, and massive online requests can also ensure high coverage.
Staking code is simple enough for low performance loss.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="diversity-support">Diversity Support<a href="#diversity-support" class="hash-link" aria-label="Direct link to Diversity Support" title="Direct link to Diversity Support">​</a></h4><p>Supports validation of data written to the service, validation of database, message queue, Redis data, and even validation of runtime in-memory data. Does not produce dirty data during testing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="stable-running-of-test-cases">Stable running of test cases<a href="#stable-running-of-test-cases" class="hash-link" aria-label="Direct link to Stable running of test cases" title="Direct link to Stable running of test cases">​</a></h4><p>Supports automatic data collection and mock for various mainstream technical frameworks, see: arex_java, and supports local time and cache, accurately restoring the data environment during production execution during replay.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="quickly-reproduce-online-issues-in-local-environment">Quickly reproduce online issues in local environment<a href="#quickly-reproduce-online-issues-in-local-environment" class="hash-link" aria-label="Direct link to Quickly reproduce online issues in local environment" title="Direct link to Quickly reproduce online issues in local environment">​</a></h4><p>Supports one-click local debugging, allowing for quick debugging of online issues in a local environment.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="safe-and-stable">Safe and stable<a href="#safe-and-stable" class="hash-link" aria-label="Direct link to Safe and stable" title="Direct link to Safe and stable">​</a></h4><p>Code isolation is also implemented in AREX, which also provides health management. During times of high system activity, AREX will intelligently reduce or turn off data collection frequency.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="good-functional-testing-support">Good functional testing support<a href="#good-functional-testing-support" class="hash-link" aria-label="Direct link to Good functional testing support" title="Direct link to Good functional testing support">​</a></h4><p>Support for test scripts and simple editing of the collected data to achieve fixed test cases, avoiding the need for extensive test data preparation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="technical-implementation">Technical Implementation<a href="#technical-implementation" class="hash-link" aria-label="Direct link to Technical Implementation" title="Direct link to Technical Implementation">​</a></h2><p>We have implemented bytecode modification using the ByteBuddy library and have encountered various challenges in the process.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="trace-transfer">Trace Transfer<a href="#trace-transfer" class="hash-link" aria-label="Direct link to Trace Transfer" title="Direct link to Trace Transfer">​</a></h3><p>During data collection, AREX collects multiple pieces of data for the same request (e.g. request/response, requests and responses for other service calls), and we need to link these pieces of data together to form a complete test case. However, our application often uses an asynchronous framework and extensively uses threads, which makes it difficult to link the data.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="java-executors">Java Executors<a href="#java-executors" class="hash-link" aria-label="Direct link to Java Executors" title="Direct link to Java Executors">​</a></h4><p>Java and various frameworks provide many thread pool implementations, and we need to ensure that Trace data can be correctly transferred between threads. Therefore, we have modified Runnable/Callable as follows:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ableWrapper implements Runnable { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private final Runnable runnable; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private final TraceTransmitter traceTransmitter;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  private RunnableWrapper(Runnable runnable) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.runnable = runnable; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    this.traceTransmitter = TraceTransmitter.create(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override public void run() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try (TraceTransmitter tm = traceTransmitter.transmit()) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      runnable.run(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override public boolean equals(Object o) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (this == o) return true; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (o == null || getClass() != o.getClass()) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RunnableWrapper that = (RunnableWrapper) o; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return runnable.equals(that.runnable); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override public int hashCode() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return runnable.hashCode(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  @Override public String toString() { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return this.getClass().getName() + &quot; - &quot; + runnable.toString(); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  public static Runnable get(Runnable runnable) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (null == runnable || TraceContextManager.get() == null) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return runnable; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (runnable instanceof RunnableWrapper) { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return runnable; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new RunnableWrapper(runnable); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, the code modifies various thread pools by replacing Runnable/Callable with Wrapper, and Wrapper ensures the correct transfer of Trace through TraceTransmitter internally.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="forkjoinpool">ForkJoinPool<a href="#forkjoinpool" class="hash-link" aria-label="Direct link to ForkJoinPool" title="Direct link to ForkJoinPool">​</a></h4><p>CompletableFuture and the default parallel stream processing of data sets use ForkJoinPool, which is also commonly used in heavily parallelized applications. This has significant differences from the typical thread pool implementation and requires separate handling. We have modified the ForkJoinPool task unit ForkJoinTask, which is more complex to implement than Runnable and is difficult to handle in a simple way. In order to not disrupt the original class structure (Agent on attach method does not support modification either), we did not add a field on this class to implement data transfer, but instead used a WeakCache for data buffering to ensure trace transfer between the task generation and execution threads.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="async">Async<a href="#async" class="hash-link" aria-label="Direct link to Async" title="Direct link to Async">​</a></h4><p>There are many asynchronous frameworks (Reactor, RxJava etc.) in the Java ecosystem, and many libraries also provide asynchronous implementations, such as lettuce provides both synchronous and asynchronous access to Redis. Different scenarios often require different solutions. For example, ApacheAsyncClient uses fixed running threads to listen for responses and initiate Callbacks. We need to ensure that Trace is correctly passed across threads in the entire process of calling, listening and callback. You can refer to ApacheAsyncClient for specific implementation.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="other">Other<a href="#other" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">​</a></h4><h5 class="anchor anchorWithStickyNavbar_LWe7" id="version-management">Version Management<a href="#version-management" class="hash-link" aria-label="Direct link to Version Management" title="Direct link to Version Management">​</a></h5><p>Popular components often have multiple versions in use in different systems at the same time, and the implementation methods of different versions may vary greatly or even be incompatible. AREX also supports multiple versions (such as Jedis). We need to ensure that we can inject bytecode based on the correct version to avoid running errors. Bytecode injection is performed during class loading, so we must identify the component versions that the application depends on before these classes are loaded, and then match the versions during class loading to ensure correct code injection. You can refer to VersionMatch for part of the implementation.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="time-management">Time Management<a href="#time-management" class="hash-link" aria-label="Direct link to Time Management" title="Direct link to Time Management">​</a></h5><p>Many business systems are time-sensitive, and different time accesses often return different results. Therefore, we have also implemented the time Mock function. Because replay is executed in parallel, it is not appropriate to modify the machine time of the test machine (and many servers cannot modify the current time). Therefore, the time Mock is still implemented at the code level.
During data collection, we record the current time for each case. During replay, we will mock System.currentTimeMills (many time underlying Java is through this method), and the time-sensitive methods related to the current time will get the correct time value through this method. This can ensure that the replay result is consistent with the collection.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="local-cache">Local Cache<a href="#local-cache" class="hash-link" aria-label="Direct link to Local Cache" title="Direct link to Local Cache">​</a></h5><p>Business applications may use various caches to improve runtime performance, and there may be significant differences in these data in different environments (syncing data between multiple environments is often a complex process). These data differences may result in completely different execution results. To avoid this problem, AREX also supports the collection and Mock of local cache data. With some simple configuration, data can be automatically collected and mocked. Of course, this function also supports Mock of various memory data.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="code-isolation-and-interoperability">Code Isolation and Interoperability<a href="#code-isolation-and-interoperability" class="hash-link" aria-label="Direct link to Code Isolation and Interoperability" title="Direct link to Code Isolation and Interoperability">​</a></h5><p>To ensure system stability, the AREX agent&#x27;s framework code is loaded in a separate Class loader and is not interoperable with application code. To ensure that injected code can be accessed correctly at runtime, we have also modified the ClassLoader to ensure that runtime code is loaded by the correct ClassLoader (think SpringBoot&#x27;s LaunchedURLClassLoader).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="arex-composition">AREX Composition<a href="#arex-composition" class="hash-link" aria-label="Direct link to AREX Composition" title="Direct link to AREX Composition">​</a></h3><p>AREX is composed of multiple modules, including Front, Schedule Service, Storage Service, Report Service, and data storage such as Mongodb, Redis.</p><p><img loading="lazy" alt="组成模块" src="/website/assets/images/arch-d5550e2b2b3094a185b1ab167fdcb3c4.png" width="834" height="587" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="arex-ui">AREX UI<a href="#arex-ui" class="hash-link" aria-label="Direct link to AREX UI" title="Direct link to AREX UI">​</a></h4><p>The AREX Front End is the front-end operator interface for AREX tools.</p><p><img loading="lazy" alt="前端界面" src="/website/assets/images/front-7b9e74df0e854909b8d0d33bbad98692.png" width="3836" height="1861" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="schedule-service">Schedule Service<a href="#schedule-service" class="hash-link" aria-label="Direct link to Schedule Service" title="Direct link to Schedule Service">​</a></h4><p>The Schedule Service is responsible for sending case replay requests to the tested service and triggering result comparisons and dependency comparisons after the service responds.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="storage-service">Storage Service<a href="#storage-service" class="hash-link" aria-label="Direct link to Storage Service" title="Direct link to Storage Service">​</a></h4><p>The Storage Service is responsible for receiving and storing the actual data of requests, responses, and dependencies captured by Agent, and returning stored data as requested by Agent during replay.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="report-service">Report Service<a href="#report-service" class="hash-link" aria-label="Direct link to Report Service" title="Direct link to Report Service">​</a></h4><p>The Report Service is responsible for collecting and displaying test results and issues during the execution of replay testing.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="data-storage">Data Storage<a href="#data-storage" class="hash-link" aria-label="Direct link to Data Storage" title="Direct link to Data Storage">​</a></h4><p>The Redis storage service is responsible for caching data during replay;</p><p>The MongoDB storage service is responsible for storing recorded data and replay results.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/intro.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--next" href="/website/docs/category/get-started"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Get Started</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a><ul><li><a href="#background" class="table-of-contents__link toc-highlight">Background</a></li><li><a href="#what-is-arex" class="table-of-contents__link toc-highlight">What is AREX?</a></li><li><a href="#advantages" class="table-of-contents__link toc-highlight">Advantages</a></li></ul></li><li><a href="#technical-implementation" class="table-of-contents__link toc-highlight">Technical Implementation</a><ul><li><a href="#trace-transfer" class="table-of-contents__link toc-highlight">Trace Transfer</a></li><li><a href="#arex-composition" class="table-of-contents__link toc-highlight">AREX Composition</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://arextest.github.io/arex-doc/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documents<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/arextest" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/AREX_Test" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Licenses<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 My Project, Inc. Built with Trip.com.</div></div></div></footer></div>
<script src="/website/assets/js/runtime~main.22450e7a.js"></script>
<script src="/website/assets/js/main.b1b7ac85.js"></script>
</body>
</html>